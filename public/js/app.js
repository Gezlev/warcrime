const downloadApp=()=>{let e=document.querySelector(".modal-app");var t,a;e&&(t=sessionStorage.getItem("apppopup"),a=navigator.userAgent,a=/android/i.test(a)?"Android":["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document?"iOS":"Other",console.log(t),console.log(a),"iOS"==a&&e.classList.add("modal-app_ios"),"Android"!=a&&"iOS"!=a||"closed"===t||setTimeout(()=>e.classList.add("visible"),2e3),e.querySelector(".modal-app__close").addEventListener("click",()=>{e.classList.remove("visible"),sessionStorage.setItem("apppopup","closed")},{passive:!0}))};function generateSessionId(){return Date.now()+Math.random().toString(36).substring(2,9)}downloadApp(),document.getElementById("sessionId").value=generateSessionId();const birthDate=new Datepicker(document.querySelector('input[name="birthday"]'),{defaultViewDate:new Date("2004-01-01"),format:"dd.mm.yyyy",weekStart:1,autohide:!0}),eventPeriod=document.querySelector("#eventPeriod");let rangepicker=new DateRangePicker(eventPeriod,{format:"dd.mm.yyyy",weekStart:1,autohide:!0}),allowed_size_mb=(!function(){"use strict";var e=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(e).forEach(function(i){i.addEventListener("keydown",function(e){"Enter"==e.key&&e.preventDefault()}),i.addEventListener("submit",function(e){if(e.preventDefault(),e.stopPropagation(),i.checkValidity()){document.querySelector("button[type='submit']").disabled=!0,document.getElementById("sessionId").value=generateSessionId();const l="https://pe0gz3li04.execute-api.eu-central-1.amazonaws.com/api-dev",i=document.forms["google-sheet"];let e=new FormData(i),a=(e.append("copy",!1),e.set("birthday",transformDate(i.birthday.value)),i.eventStart.value&&e.set("eventStart",transformDate(i.eventStart.value)+" "+(i.timeStart.value||"00:00")),i.eventEnd.value&&e.set("eventEnd",transformDate(i.eventEnd.value)+" "+(i.timeEnd.value||"23:59")),e.delete("timeStart"),e.delete("timeEnd"),{}),t=(e.forEach((e,t)=>a[t]=e),a.eventType=e.getAll("eventType"),JSON.stringify(a)),n=document.getElementById("formFile"),o;axios({method:"post",url:l,data:t,responseType:"json"}).then(e=>{let t="";i.surname.value&&(t+="Name"),i.tel.value&&(t+="Tel"),""!=i.email.value&&(t+="Email"),dataLayer.push({event:"analytics",analytics:{sessionId:i.sessionId.value,filesCount:n.files.length,contactFields:t,administrative_area_level_1:i.administrative_area_level_1.value}}),e.data.url?o=e.data.url:console.log("fileUploadUrl not received")}).then(()=>{uploadFiles(n.files,o,l,t.replace('"copy":"false"','"copy":"true"')).then(()=>{document.getElementById("modal").style.display="block"})}).catch(e=>{console.error("Error!",e.message)})}i.classList.add("was-validated");let t=document.querySelector(".was-validated :invalid");t&&t.scrollIntoView({behavior:"smooth"})},!1)})}(),navigator.geolocation||(document.getElementById("button-location").style.display=none),100),inputs=document.getElementById("formFile");inputs.addEventListener("change",function(l){document.getElementById("fileName").innerHTML="";for(let o=0;o<l.target.files.length;o++){var i=l.target.files[o];let e=document.createElement("div"),t='<div class="progress"><div class="progress-bar" role="progressbar" style="width: 0" filename="'+i.name+'">0%</div></div>',a=document.createElement("div"),n=(a.innerHTML=t.trim(),t=a.firstChild,document.createElement("span"));n.className="badge bg-warning",n.setAttribute("fileName",i.name),n.innerText="x",n.addEventListener("click",function(t){for(let e=0;e<l.target.files.length;e++)if(l.target.files[e].name==t.target.getAttribute("fileName")){removeFileFromFileList(e,l.target);break}t.target.parentNode.remove()}),e.innerText=i.name,i.size>1024*allowed_size_mb*1024&&(e.classList.add("text-danger"),e.innerText+="Файл може дового завантажуватися через великий розмір"),e.appendChild(n),e.appendChild(t),document.getElementById("fileName").appendChild(e)}}),grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute("6Le_V7MeAAAAAKZ9kPfj_NVex4siD8oErqRuy499",{action:"homepage"}).then(function(e){document.querySelector("input[name='googleReCaptcha']").value=e})});const removeFileFromFileList=function(t,e){const a=new DataTransfer;var n=e["files"];for(let e=0;e<n.length;e++){var o=n[e];t!==e&&a.items.add(o)}e.files=a.files};var fileUploadProgress=function(e,t){let a=document.querySelector("div.progress-bar[filename='"+t+"']");t=Math.round(100*e.loaded/e.total);a.style.width=t+"%",a.innerText=t+"%"},uploadFiles=async function(t,a,n,o){let l=0;for(const i of t){if(!a)return;let e=new FormData;e.append("image",i),await axios.put(a,i,{headers:{"Content-Type":i.type},onUploadProgress:function(e,t=i.name){fileUploadProgress(e,t)}}).then(()=>{var e=i.type?i.type.split("/")[0]:"unknow";dataLayer.push({event:"fileUpload",file:{sessionId:document.forms["google-sheet"].sessionId.value,type:e}})}),l<t.length-1&&await axios({method:"post",url:n,data:o,responseType:"json"}).then(e=>{e.data.url&&(a=e.data.url)}).catch(e=>{console.log(e)}),l++}};let keyCode;function mask(e){e.keyCode&&(keyCode=e.keyCode);this.selectionStart<3&&e.preventDefault();var t="+38 ___ ___ __ __",a=0,n=t.replace(/\D/g,""),o=this.value.replace(/\D/g,""),l=t.replace(/[_\d]/g,function(e){return a<o.length?o.charAt(a++)||n.charAt(a):e}),t=(-1!=(a=l.indexOf("_"))&&(a<5&&(a=3),l=l.slice(0,a)),t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&"));(!(t=new RegExp("^"+t+"$")).test(this.value)||this.value.length<5||47<keyCode&&keyCode<58)&&(this.value=l),"blur"==e.type&&this.value.length<5&&(this.value="")}function transformDate(e){let t=e.split(".");return t.reverse().join("-")}const tel=document.querySelector("#phone");tel.addEventListener("input",mask,!1),tel.addEventListener("focus",mask,!1),tel.addEventListener("blur",mask,!1),tel.addEventListener("keydown",mask,!1);